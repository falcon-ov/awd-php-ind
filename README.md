# JobVocab - Веб-приложение для изучения профессиональной терминологии

## Описание лабораторной работы

**JobVocab** — это веб-приложение, разработанное для изучения профессиональной терминологии через интерактивные квизы. Приложение позволяет пользователям регистрироваться, проходить квизы, предлагать новые термины и управлять ими. Администраторы имеют расширенные функции для управления терминами, пользователями, квизами и предложениями терминов. Проект реализован с использованием PHP на серверной стороне, SQLite для хранения данных и HTML/CSS для интерфейса. Приложение соответствует требованиям индивидуальной работы, включая аутентификацию, общедоступные и защищённые компоненты, формы, безопасность и модульную архитектуру.

---

## Инструкции по запуску проекта

### Требования
- PHP 8.1 или выше
- SQLite3
- Веб-сервер (встроенный сервер PHP или Apache/Nginx)
- Git (для клонирования репозитория)

### Установка
1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/your-username/jobvocab.git
   cd jobvocab
   ```
2. Создайте базу данных SQLite:
   ```bash
   php init_db.php
   ```
   Это создаст файл `data/jobvocab.db` с начальными данными (админ: `admin`, пароль: `admin123`).
3. Запустите встроенный сервер PHP:
   ```bash
   php -S localhost:8088 -t public
   ```
4. Откройте приложение в браузере: `http://localhost:8088`

### Конфигурация
- Убедитесь, что папка `data/` имеет права на запись для SQLite.
- Основные файлы:
  - `public/index.php` — точка входа.
  - `app/` — содержит контроллеры, модели, представления и маршруты.
  - `public/css/style.css` — стили интерфейса.

---

## Документация проекта

### Содержание
1. Функциональные возможности
2. Сценарии взаимодействия пользователей с приложением
3. Структура базы данных
4. Примеры использования
5. Ответы на контрольные вопросы
6. Список использованных источников

### Функциональные возможности

#### Аутентификация пользователей
- **Регистрация** (`/register`): Пользователи могут создать учётную запись, указав имя пользователя, email и пароль. Пароли хешируются с помощью `password_hash()`.
- **Вход** (`/login`): Аутентификация по имени пользователя и паролю с проверкой хеша через `password_verify()`.
- **Выход** (`/logout`): Завершение сессии.
- **Безопасность**: Используются сессии для управления доступом, данные валидируются на сервере, защита от XSS через `htmlspecialchars()`.
- **Роли**: Пользователи делятся на `user` (обычные пользователи) и `admin` (администраторы с расширенными правами).

#### Общедоступный компонент
- **Главная страница** (`/`): Отображает список всех активных терминов, извлечённых из базы данных.
- **Поиск** (`/search`): Позволяет искать термины по ключевому слову (название или определение).
- **Квизы** (`/quiz`): Доступны для всех, отображают список публичных квизов с динамическим формированием вопросов.

#### Формы взаимодействия
1. **Форма создания ресурса**:
   - **Предложение термина** (`/term/suggest`, только для пользователей):
     - Поля: название термина, определение, категория (выпадающий список), источник, согласие с правилами (чекбокс).
     - Валидация: клиентская (JavaScript, обязательные поля) и серверная (проверка длины, форматов, уникальности).
     - Обработка ошибок: отображение сообщений (например, «Название термина уже существует»).
   - **Создание квиза** (`/quiz/create`, для авторизованных):
     - Поля: название квиза, публичность (чекбокс, только для админов), выбор терминов (множественный выбор), описание.
     - Валидация: проверка обязательных полей, корректности ID терминов.
2. **Форма поиска** (`/search`):
   - Поле ввода для ключевого слова.
   - Серверная обработка запроса с использованием SQL-запроса `LIKE`.
   - Результаты отображаются динамически.

#### Защищённый компонент
- **Для авторизованных пользователей**:
  - **Мои термины** (`/term/list`): Список терминов пользователя с их статусом (активен/неактивен). Пользователи могут предлагать новые термины.
  - **Прохождение квиза** (`/quiz`): Пользователи могут проходить квизы и видеть результаты.
- **Для администраторов**:
  - **Админ-панель** (`/admin/dashboard`): Статистика (термины, пользователи, квизы).
  - **Управление терминами** (`/admin/terms`): Просмотр, добавление, редактирование, удаление терминов.
  - **Управление пользователями** (`/admin/users`): Просмотр, удаление, изменение ролей (назнаение администратора).
  - **Управление квизами** (`/admin/quizzes`): Просмотр, создание, удаление квизов.
  - **Управление предложениями терминов** (`/admin/suggestions`): Одобрение или отклонение предложенных терминов.

#### Безопасность
- **Валидация данных**: Все формы проверяются на сервере (функция `validateInput()`), защита от SQL-инъекций через PDO.
- **Хеширование паролей**: Используется `password_hash()` с алгоритмом BCRYPT.
- **Сессии**: Управление доступом через `$_SESSION`, защита от обхода аутентификации.
- **XSS**: Экранирование вывода через `htmlspecialchars()`.

#### Архитектура
- Приложение построено по модели MVC:
  - **Model**: `Term.php`, `Quiz.php`, `User.php` — взаимодействие с базой данных.
  - **View**: Шаблоны в `app/views/` (например, `term/list.php`, `admin/dashboard.php`).
  - **Controller**: `AuthController.php`, `PublicController.php`, `AdminController.php`, `TermController.php` — обработка запросов.
- Маршруты определены в `app/routes.php`.

### Сценарии взаимодействия пользователей

1. **Гость**:
   - Просматривает главную страницу с терминами (`/`).
   - Ищет термины через поиск (`/search`).
   - Просматривает список квизов (`/quiz`) и может начать квиз без авторизации.
   - Регистрируется (`/register`) или входит (`/login`).

2. **Обычный пользователь**:
   - После входа видит навигацию с «Предложить термин» и «Мои термины».
   - Предлагает термин через `/term/suggest`, получает сообщение об отправке на проверку.
   - Просматривает свои термины на `/term/list` с их статусом.
   - Проходит квизы (`/quiz`) и видит результаты (`/quiz/result`).

3. **Администратор**:
   - После входа получает доступ к админ-панели (`/admin/dashboard`).
   - Управляет терминами: добавляет, редактирует, удаляет (`/admin/terms`).
   - Управляет пользователями: удаляет, назначает админов (`/admin/users`).
   - Управляет квизами: создаёт, удаляет (`/admin/quizzes`).
   - Одобряет или отклоняет предложения терминов (`/admin/suggestions`).

### Структура базы данных

База данных SQLite (`data/jobvocab.db`) содержит следующие таблицы:

1. **users**:
   - `id` (INTEGER, PRIMARY KEY): ID пользователя.
   - `username` (TEXT): Имя пользователя.
   - `email` (TEXT): Email.
   - `password` (TEXT): Хешированный пароль.
   - `role` (TEXT): Роль (`user` или `admin`).

2. **terms**:
   - `id` (INTEGER, PRIMARY KEY): ID термина.
   - `title` (TEXT): Название термина.
   - `definition` (TEXT): Определение.
   - `category` (TEXT): Категория.
   - `source` (TEXT): Источник.
   - `status` (TEXT): Статус (`active` или `inactive`).
   - `user_id` (INTEGER): ID автора (FOREIGN KEY).

3. **quizzes**:
   - `id` (INTEGER, PRIMARY KEY): ID квиза.
   - `title` (TEXT): Название квиза.
   - `user_id` (INTEGER): ID создателя.
   - `is_public` (INTEGER): Публичность (0 или 1).

4. **quiz_terms**:
   - `quiz_id` (INTEGER): ID квиза (FOREIGN KEY).
   - `term_id` (INTEGER): ID термина (FOREIGN KEY).

5. **term_suggestions**:
   - `id` (INTEGER, PRIMARY KEY): ID предложения.
   - `title` (TEXT): Название термина.
   - `definition` (TEXT): Определение.
   - `category` (TEXT): Категория.
   - `source` (TEXT): Источник.
   - `user_id` (INTEGER): ID автора (FOREIGN KEY).
   - `status` (TEXT): Статус (`pending`, `approved`, `rejected`).

6. **quiz_results**:
   - `id` (INTEGER, PRIMARY KEY): ID результата.
   - `user_id` (INTEGER): ID пользователя.
   - `quiz_id` (INTEGER): ID квиза.
   - `score` (INTEGER): Счёт.
   - `total_questions` (INTEGER): Всего вопросов.
   - `created_at` (DATETIME): Дата прохождения.

---

### Примеры использования

#### Скриншоты
1. **Главная страница**:
   - Отображает список терминов.
   - Пример: «Термин: API, Определение: Интерфейс программирования приложений».

2. **Форма предложения термина** (`/term/suggest`):
   - Поля: Название, Определение, Категория (выпадающий список), Источник, Чекбокс согласия.
   - Ошибка: «Название термина обязательно».

3. **Админ-панель** (`/admin/dashboard`):
   - Карточки с количеством терминов, пользователей, квизов.
   - Пример: «Всего терминов: 10, Всего пользователей: 5, Всего квизов: 3».

4. **Квиз** (`/quiz`):
   - Вопрос: «Что такое API?» с 4 вариантами ответа.
   - Результат: «Ваш счёт: 8 из 10».

#### Фрагменты кода
- **Валидация формы** (`TermController.php`):
  ```php
  public function suggest() {
      if ($_SESSION['role'] === 'admin') {
          $_SESSION['message'] = 'Администраторы не могут предлагать термины.';
          header('Location: /');
          exit;
      }
      if ($_SERVER['REQUEST_METHOD'] === 'POST') {
          $title = validateInput($_POST['title']);
          $definition = validateInput($_POST['definition']);
          if (empty($title) || empty($definition)) {
              $_SESSION['error'] = 'Название и определение обязательны.';
              header('Location: /term/suggest');
              exit;
          }
          Term::suggest($title, $definition, $_POST['category'], $_POST['source'], $_SESSION['user_id']);
          $_SESSION['message'] = 'Предложение отправлено на проверку.';
          header('Location: /term/list');
          exit;
      }
      require __DIR__ . '/../views/term/suggest.php';
  }
  ```

- **Стили футера** (`public/css/style.css`):
  ```css
  footer {
      background: #333;
      color: white;
      text-align: center;
      padding: 10px;
      width: 100%;
  }
  ```

---

### Ответы на контрольные вопросы

1. **Как реализована аутентификация пользователей?**
   - Аутентификация реализована через формы регистрации (`/register`) и входа (`/login`). Пароли хешируются с помощью `password_hash()` и проверяются через `password_verify()`. Сессии (`$_SESSION`) используются для хранения `user_id` и `role`. Защищённые разделы доступны только после проверки `$_SESSION['user_id']`.

2. **Какие меры безопасности применены?**
   - Валидация всех входных данных через `validateInput()`. Защита от SQL-инъекций с PDO. Экранирование вывода через `htmlspecialchars()`. Хеширование паролей. Проверка ролей для доступа к админ-функциям.

3. **Как организована модульная архитектура?**
   - Приложение использует MVC: модели (`Term.php`, `Quiz.php`) для работы с базой, представления (`app/views/`) для интерфейса, контроллеры (`PublicController.php`, `AdminController.php`) для логики. Маршруты определены в `routes.php`.

4. **Как реализованы формы?**
   - Форма `/term/suggest` включает 5 полей с клиентской (JavaScript) и серверной валидацией. Форма `/search` позволяет искать термины по ключевому слову. Ошибки отображаются через `$_SESSION['error']`.

5. **Какие функции доступны администратору?**
   - Управление терминами, пользователями, квизами, предложениями терминов; назначение ролей администратора; просмотр статистики.

---

### Список использованных источников

1. PHP Documentation - [https://www.php.net/manual/](https://www.php.net/manual/)
2. SQLite Documentation - [https://www.sqlite.org/docs.html](https://www.sqlite.org/docs.html)
3. OWASP Secure Coding Practices - [https://owasp.org/www-project-secure-coding-practices/](https://owasp.org/www-project-secure-coding-practices/)
4. MDN Web Docs (CSS Flexbox) - [https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout)
5. PHP The Right Way - [https://phptherightway.com/](https://phptherightway.com/)

---

## Другие важные аспекты

- **PHPDoc**: Все методы в контроллерах и моделях документированы с описанием параметров и возвращаемых значений.
- **Производительность**: Использование PDO и индексов в базе данных для быстрого поиска.
- **Расширяемость**: Модульная структура позволяет легко добавлять новые функции, например, восстановление пароля или историю квизов.
- **Ограничения**: Отсутствует восстановление пароля (дополнительное задание), но это можно реализовать через email.