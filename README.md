# JobVocab - Веб-приложение для изучения профессиональных терминов

## Описание лабораторной работы

**JobVocab** — это веб-приложение, разработанное в рамках индивидуальной работы по курсу веб-программирования. Приложение представляет собой словарь профессиональных терминов с функцией создания квизов для проверки знаний. Оно включает функционал аутентификации, управления терминами, квизами и предложениями терминов, а также публичный раздел для поиска и просмотра терминов. Приложение построено на модульной архитектуре MVC с использованием PHP и SQLite.

Цель работы: разработать веб-приложение средней сложности с серверной логикой, отвечающее требованиям задания, включая аутентификацию, защищённые и общедоступные компоненты, формы взаимодействия и управление данными.

---

## Инструкции по запуску проекта

### Требования
- PHP 7.4 или выше
- SQLite3
- Веб-сервер встроенный сервер PHP

### Установка
1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/falcon-ov/awd-php-ind
   cd awd-php-ind
   ```

2. **Инициализация базы данных**:
   Выполните скрипт для создания структуры базы данных и добавления тестовых данных:
   ```bash
   php init_db.php
   ```
   Это создаст файл `data/jobvocab.db` с таблицами и тестовыми данными (админ: логин `admin`, пароль `admin123`).

3. **Настройка веб-сервера**:
   - Убедитесь, что корневая папка сервера указывает на директорию `public/`.
   - Если используете встроенный сервер PHP:
     ```bash
     php -S localhost:8088 -t public/
     ```

4. **Настройка фонового изображения** (опционально):
   - Поместите изображение (например, `background.jpg`) в папку `public/css/` для использования в качестве фона.

5. **Доступ к приложению**:
   Откройте браузер и перейдите по адресу `http://localhost:8088`.

---

## Документация проекта

### Содержание
1. Функциональные возможности
2. Сценарии взаимодействия пользователей
3. Структура базы данных
4. Стилизация
5. Примеры использования
6. Ответы на контрольные вопросы
7. Список использованных источников

### 1. Функциональные возможности

#### Аутентификация
- **Регистрация**: Пользователи могут создать учётную запись, указав логин, email и пароль. Пароли хешируются с использованием алгоритма BCRYPT.
- **Вход**: Авторизация по логину и паролю. После входа пользователь получает доступ к защищённым разделам.
- **Выход**: Завершение сессии.
- **Безопасность**: Все данные валидируются, пароли хранятся в хешированном виде, используются сессии для управления доступом.

#### Общедоступный компонент
- **Главная страница**: Отображает список всех активных терминов, извлечённых из базы данных.
- **Поиск терминов**: Форма поиска позволяет находить термины по ключевым словам с динамическим отображением результатов.
- **Квизы**: Публичные квизы доступны всем пользователям для прохождения.

#### Формы взаимодействия
- **Форма создания квиза** (`/quiz/create`):
  - Поля: название квиза, выбор терминов (чекбоксы с названиями и определениями терминов).
  - Валидация на клиенте (обязательные поля) и сервере (защита от XSS, проверка выбора минимум одного термина).
  - Ошибки отображаются в виде сообщений.
- **Форма поиска терминов**:
  - Поля: текстовое поле для ключевого слова.
  - Динамическая фильтрация терминов из базы данных.
- **Форма предложения термина** (`/term/suggest`):
  - Поля: название и определение термина.
  - Доступна только авторизованным пользователям.

#### Защищённый компонент
- Доступен только авторизованным пользователям.
- **Роль администратора**:
  - **Управление терминами** (`/admin/terms`): создание, редактирование, удаление терминов с валидацией статуса (`active`/`inactive`).
  - **Управление пользователями** (`/admin/users`): создание новых учётных записей (включая выбор роли `user`/`admin`), удаление пользователей (кроме самого себя).
  - **Управление квизами** (`/admin/quizzes`): создание и удаление квизов с выбором терминов.
  - **Управление предложениями терминов** (`/admin/suggestions`): просмотр, одобрение (с выбором статуса) или отклонение предложенных терминов.
- **Роль пользователя**:
  - Предложение терминов на модерацию через `/term/suggest`.
  - Создание личных квизов через `/quiz/create`.

#### Дополнительные функции
- **Предложение терминов**: Пользователи могут предлагать термины, которые отправляются на проверку администратору.
- **Квизы**: Пользователи могут создавать квизы, выбирая термины (с отображением их определений), и проходить их, получая результаты.
- **Статистика**: Админ-панель (`/admin/dashboard`) отображает количество терминов, пользователей и квизов.

### 2. Сценарии взаимодействия пользователей

#### Гость
1. Переходит на главную страницу, видит список терминов.
2. Использует форму поиска для фильтрации терминов.
3. Выбирает публичный квиз, проходит его и видит результат.
4. Переходит на страницу регистрации или входа для доступа к дополнительным функциям.

#### Пользователь
1. Регистрируется или входит в систему.
2. Предлагает новый термин через форму `/term/suggest`.
3. Создаёт квиз на `/quiz/create`, выбирая термины (с отображением их определений), и проходит его.
4. Проходит доступные квизы и видит результаты.

#### Администратор
1. Входит в систему с ролью `admin`.
2. Переходит в админ-панель (`/admin/dashboard`), видит статистику.
3. Управляет терминами: создаёт, редактирует, удаляет (`/admin/terms`).
4. Управляет пользователями: создаёт новые учётные записи, удаляет существующие (`/admin/users`).
5. Управляет квизами: создаёт, удаляет (`/admin/quizzes`).
6. Просматривает и модерирует предложения терминов (`/admin/suggestions`).

### 3. Структура базы данных

База данных SQLite состоит из следующих таблиц:

#### Таблица `users`
| Поле        | Тип       | Описание                              |
|-------------|-----------|---------------------------------------|
| id          | INTEGER   | Уникальный идентификатор (PK)         |
| username    | TEXT      | Имя пользователя (уникальное)         |
| password    | TEXT      | Хешированный пароль                   |
| email       | TEXT      | Email (уникальный)                    |
| role        | TEXT      | Роль (`user` или `admin`)             |
| created_at  | DATETIME  | Дата создания                         |

#### Таблица `terms`
| Поле        | Тип       | Описание                              |
|-------------|-----------|---------------------------------------|
| id          | INTEGER   | Уникальный идентификатор (PK)         |
| title       | TEXT      | Название термина                      |
| definition  | TEXT      | Определение термина                   |
| status      | TEXT      | Статус (`active` или `inactive`)      |
| created_by  | INTEGER   | ID создателя (FK: users.id)           |
| created_at  | DATETIME  | Дата создания                         |

#### Таблица `term_suggestions`
| Поле        | Тип       | Описание                              |
|-------------|-----------|---------------------------------------|
| id          | INTEGER   | Уникальный идентификатор (PK)         |
| title       | TEXT      | Название предложенного термина        |
| definition  | TEXT      | Определение термина                   |
| status      | TEXT      | Статус (`pending`)                    |
| created_by  | INTEGER   | ID автора (FK: users.id)              |
| created_at  | DATETIME  | Дата создания                         |

#### Таблица `quizzes`
| Поле        | Тип       | Описание                              |
|-------------|-----------|---------------------------------------|
| id          | INTEGER   | Уникальный идентификатор (PK)         |
| title       | TEXT      | Название квиза                        |
| user_id     | INTEGER   | ID создателя (FK: users.id)           |
| is_public   | INTEGER   | Флаг общедоступности (0 или 1)        |
| created_at  | DATETIME  | Дата создания                         |

#### Таблица `quiz_terms`
| Поле        | Тип       | Описание                              |
|-------------|-----------|---------------------------------------|
| quiz_id     | INTEGER   | ID квиза (PK, FK: quizzes.id)         |
| term_id     | INTEGER   | ID термина (PK, FK: terms.id)         |

#### Таблица `quiz_results`
| Поле            | Тип       | Описание                              |
|-----------------|-----------|---------------------------------------|
| id              | INTEGER   | Уникальный идентификатор (PK)         |
| user_id         | INTEGER   | ID пользователя (FK: users.id)        |
| quiz_id         | INTEGER   | ID квиза (FK: quizzes.id)             |
| score           | INTEGER   | Количество правильных ответов         |
| total_questions | INTEGER   | Общее количество вопросов             |
| created_at      | DATETIME  | Дата прохождения                      |

### 4. Стилизация
- **Основной цвет**: Розовый (`#e91e63`) с оттенками (`#c2185b` для ховера, `#f8bbd0` для фонов).
- **Фоновое изображение**: Поддерживается пользовательское изображение (например, `public/css/background.jpg`), растянутое на весь экран с фиксированным позиционированием.
- **Современные эффекты**:
  - Градиенты для хедера и футера.
  - Тени и скругления для форм, таблиц, карточек и элементов терминов.
  - Анимации при наведении (поднятие кнопок, масштабирование ссылок).
  - Плавное появление контента с помощью CSS-анимации (`fadeIn`).
- **Шрифты**: Используется шрифт Arial по умолчанию, с возможностью подключения Google Fonts (например, Roboto) для улучшенной типографики.
- **Чекбоксы и радио-кнопки**: Кастомизированы с розовым акцентом и увеличенным размером.
- **Адаптивность**: Стили оптимизированы для десктопов, с возможностью добавления медиа-запросов для мобильных устройств.

### 5. Примеры использования

#### Скриншоты
1. **Главная страница**:
   - Отображает список терминов в виде карточек с розовой темой и полупрозрачным фоном для читаемости.
   - Доступна всем пользователям.

2. **Форма поиска**:
   - Пользователь вводит ключевое слово, результаты фильтруются динамически в стилизованных карточках.

3. **Создание квиза** (`/quiz/create`):
   - Пользователь выбирает термины с чекбоксами, рядом с каждым термином отображается его определение (обрезается до 100 символов).
   - Форма имеет розовые акценты, тени и анимации.

4. **Админ-панель** (`/admin/dashboard`):
   - Отображает статистику в виде стилизованных карточек.
   - Ссылки на управление данными с анимацией при наведении.

#### Фрагмент кода (валидация ввода)
```php
function validateInput($input) {
    return htmlspecialchars(trim($input), ENT_QUOTES, 'UTF-8');
}
```
Этот код защищает от XSS-атак, обрабатывая пользовательский ввод.

#### Фрагмент кода (стилизация формы создания квиза)
```php
<div class="term-item">
    <label>
        <input type="checkbox" name="term_ids[]" value="<?php echo $term['id']; ?>">
        <strong><?php echo htmlspecialchars($term['title']); ?></strong>
    </label>
    <p class="term-definition"><?php echo htmlspecialchars(substr($term['definition'], 0, 100)) . (strlen($term['definition']) > 100 ? '...' : ''); ?></p>
</div>
```
Этот код отображает термины с определениями в форме создания квиза, с применением стилей `.term-item` и `.term-definition`.

### 6. Ответы на контрольные вопросы
1. **Как обеспечивается безопасность паролей?**
   Пароли хешируются с использованием алгоритма BCRYPT (`password_hash`) и хранятся в базе данных в защищённом виде. Проверка выполняется через `password_verify`.

2. **Как реализована валидация данных?**
   Все пользовательские данные проходят валидацию на клиенте (HTML5 `required`) и сервере (функция `validateInput` для защиты от XSS, проверки уникальности `username` и `email`). Ошибки отображаются пользователю в стилизованных карточках.

3. **Как организована модульная архитектура?**
   Приложение использует MVC:
   - **Model**: Классы `User`, `Term`, `Quiz` для работы с базой данных.
   - **View**: PHP-шаблоны в папке `views/` с розовой темой и анимациями.
   - **Controller**: Классы `AuthController`, `PublicController`, `TermController`, `QuizController`, `AdminController` для обработки запросов.

4. **Как работает управление сессиями?**
   Сессии (`session_start`) используются для хранения `user_id` и `role`. Доступ к защищённым разделам проверяется через `$_SESSION`.

### 7. Список использованных источников
- PHP Documentation: https://www.php.net/docs.php
- PDO SQLite: https://www.php.net/manual/en/book.sqlite3.php
- HTML5 Forms: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form
- CSS Styling: https://developer.mozilla.org/en-US/docs/Web/CSS
- BCRYPT Password Hashing: https://www.php.net/manual/en/function.password-hash.php
- Google Fonts (Roboto): https://fonts.google.com/specimen/Roboto
- CSS Animations: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Animations

---

## Другие важные аспекты
- **Архитектура**: Приложение построено по принципам MVC, что упрощает поддержку и расширение.
- **Безопасность**: Реализована защита от XSS, SQL-инъекций (через PDO) и обхода аутентификации. Все формы валидируются на клиенте и сервере.
- **Стилизация**: Приложение использует розовую тему с поддержкой фонового изображения, градиентами, тенями и анимациями для современного вида.
- **Ограничения**:
  - Функция восстановления пароля не реализована из-за ограничений времени. Возможное улучшение — интеграция с email-сервисами.
  - Удалена вкладка "Мои термины" для упрощения интерфейса.
- **Тестирование**: Тестовые данные добавляются через `init_db.php` для упрощения проверки. Рекомендуется использовать логин `admin` (пароль `admin123`) для проверки админ-панели.
